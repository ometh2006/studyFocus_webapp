<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Focus - Study Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #000000, #0a0a0a, #111111);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 10px;
            padding-bottom: 90px; /* Space for floating nav */
        }

        @media (min-width: 768px) {
            .container {
                padding: 20px;
                padding-bottom: 20px;
            }
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 15px;
            padding: 15px 10px;
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        @media (min-width: 768px) {
            .header {
                margin-bottom: 25px;
                padding: 25px 20px;
            }
        }

        .site-title {
            font-size: clamp(36px, 7vw, 64px);
            font-weight: 900;
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .site-subtitle {
            font-size: clamp(16px, 2.5vw, 20px);
            color: #43e97b;
            font-weight: 600;
            text-shadow: 0 0 20px rgba(67, 233, 123, 0.5);
        }

        /* Navigation */
        nav {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 12px 10px;
            border-radius: 15px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        @media (min-width: 768px) {
            nav {
                padding: 18px;
                margin-bottom: 25px;
            }
        }

        .nav-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
        }

        @media (min-width: 768px) {
            .nav-buttons {
                display: flex;
                gap: 10px;
                justify-content: center;
                flex-wrap: wrap;
            }
        }

        .nav-btn {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            border: none;
            color: white;
            padding: 10px 8px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(61, 78, 138, 0.4);
            min-height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        @media (min-width: 768px) {
            .nav-btn {
                padding: 12px 25px;
                font-size: 15px;
                border-radius: 25px;
                min-height: auto;
            }
        }

        .nav-btn:hover, .nav-btn:active {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(61, 78, 138, 0.6);
        }

        .nav-btn.active {
            background: linear-gradient(135deg, #8a4a7a 0%, #7a2e3e 100%);
            box-shadow: 0 4px 15px rgba(138, 74, 122, 0.4);
        }

        /* Logout Button */
        .logout-btn {
            background: linear-gradient(135deg, #8a3a4a 0%, #7a5a2a 100%);
            border: none;
            color: white;
            padding: 10px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(138, 58, 74, 0.4);
            grid-column: span 4;
            margin-top: 8px;
            min-height: 45px;
        }

        @media (min-width: 768px) {
            .logout-btn {
                padding: 12px 25px;
                font-size: 15px;
                border-radius: 25px;
                grid-column: auto;
                margin-top: 0;
                min-height: auto;
            }
        }

        /* Panels */
        .panel {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Daily Goal Progress */
        .daily-goal-container {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 20px;
            margin-bottom: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        @media (min-width: 768px) {
            .daily-goal-container {
                padding: 25px;
                margin-bottom: 25px;
            }
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .goal-header h2 {
            font-size: clamp(18px, 3vw, 24px);
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .goal-controls {
            display: flex;
            gap: 8px;
        }

        .goal-btn {
            background: rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(102, 126, 234, 0.5);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        @media (min-width: 768px) {
            .goal-btn {
                padding: 8px 16px;
                font-size: 14px;
            }
        }

        .goal-progress {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .progress-ring-container {
            position: relative;
            width: 100px;
            height: 100px;
        }

        @media (min-width: 768px) {
            .progress-ring-container {
                width: 120px;
                height: 120px;
            }
        }

        .progress-ring {
            transform: rotate(-90deg);
            width: 100%;
            height: 100%;
        }

        .progress-ring-bg {
            fill: none;
            stroke: rgba(61, 78, 138, 0.3);
            stroke-width: 8;
        }

        .progress-ring-fill {
            fill: none;
            stroke: #43e97b;
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .progress-text .completed {
            font-size: 24px;
            font-weight: bold;
            color: #43e97b;
        }

        @media (min-width: 768px) {
            .progress-text .completed {
                font-size: 28px;
            }
        }

        .progress-text .target {
            font-size: 14px;
            opacity: 0.8;
        }

        .goal-stats {
            flex: 1;
        }

        .goal-stat {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .goal-stat span {
            color: #43e97b;
            font-weight: bold;
        }

        /* Subject Cards */
        .subjects-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        @media (max-width: 767px) {
            .subjects-container {
                grid-template-columns: 1fr;
            }
        }

        .subject-card {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            padding: 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 3px solid transparent;
        }

        .subject-card:nth-child(2) {
            background: linear-gradient(135deg, #8a4a7a 0%, #7a2e3e 100%);
        }

        .subject-card:nth-child(3) {
            background: linear-gradient(135deg, #2a5a7a 0%, #1a6a7a 100%);
        }

        .subject-card:nth-child(4) {
            background: linear-gradient(135deg, #2a6e4a 0%, #1a5a5a 100%);
        }

        .subject-card:nth-child(5) {
            background: linear-gradient(135deg, #8a3a4a 0%, #7a5a2a 100%);
        }

        .subject-card:nth-child(6) {
            background: linear-gradient(135deg, #1a5a5a 0%, #2a1a4a 100%);
        }

        .subject-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .subject-card.selected {
            border: 3px solid #43e97b;
            box-shadow: 0 0 30px rgba(67, 233, 123, 0.6);
            animation: glow 1.5s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 30px rgba(67, 233, 123, 0.6);
            }
            50% {
                box-shadow: 0 0 50px rgba(67, 233, 123, 0.9);
            }
        }

        .subject-card h3 {
            font-size: clamp(18px, 3vw, 22px);
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subject-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
            font-size: 12px;
        }

        .subject-stat {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .todo-section {
            margin-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 10px;
        }

        .todo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .todo-header h4 {
            font-size: 14px;
            opacity: 0.9;
        }

        .add-todo-btn {
            background: rgba(67, 233, 123, 0.2);
            border: 1px solid rgba(67, 233, 123, 0.5);
            color: #43e97b;
            padding: 4px 10px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
        }

        .todo-list {
            max-height: 150px;
            overflow-y: auto;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            margin-bottom: 5px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .todo-item:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .todo-item.completed .todo-text {
            text-decoration: line-through;
            opacity: 0.6;
        }

        .todo-checkbox {
            width: 18px;
            height: 18px;
            border: 2px solid rgba(102, 126, 234, 0.5);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
        }

        .todo-checkbox.checked {
            background: #43e97b;
            border-color: #43e97b;
        }

        .todo-checkbox.checked:after {
            content: "‚úì";
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .todo-text {
            flex: 1;
            font-size: 13px;
        }

        .todo-delete {
            background: rgba(255, 0, 0, 0.2);
            border: none;
            color: #ff6b6b;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .subject-card .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .subject-card .remove-btn:hover {
            background: rgba(255, 0, 0, 0.8);
            transform: rotate(90deg);
        }

        /* Add Subject */
        .add-subject-btn {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            border: 2px dashed rgba(255, 255, 255, 0.5);
            color: white;
            padding: 25px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100px;
            width: 100%;
        }

        @media (min-width: 768px) {
            .add-subject-btn {
                padding: 30px;
                min-height: 120px;
                font-size: 18px;
            }
        }

        .add-subject-btn:hover {
            transform: scale(1.05);
            border-color: white;
        }

        /* Timer Section */
        .timer-section {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px 15px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        @media (min-width: 768px) {
            .timer-section {
                padding: 35px;
                margin-bottom: 25px;
            }
        }

        .timer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .pomodoro-counter {
            background: rgba(61, 78, 138, 0.3);
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 14px;
        }

        .timer-display {
            font-size: clamp(48px, 12vw, 96px);
            font-weight: 700;
            margin: 20px 0;
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        @media (min-width: 768px) {
            .timer-controls {
                gap: 20px;
                margin-top: 30px;
            }
        }

        .timer-btn {
            background: linear-gradient(135deg, #2a6e4a 0%, #1a5a5a 100%);
            border: none;
            color: white;
            padding: 14px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(42, 110, 74, 0.4);
            touch-action: manipulation;
            min-width: 120px;
            min-height: 50px;
        }

        @media (min-width: 768px) {
            .timer-btn {
                padding: 16px 35px;
                font-size: 17px;
                min-width: 140px;
            }
        }

        .timer-btn:hover:not(:disabled), .timer-btn:active:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(42, 110, 74, 0.6);
        }

        .timer-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .timer-btn.stop {
            background: linear-gradient(135deg, #8a3a4a 0%, #7a5a2a 100%);
            box-shadow: 0 4px 15px rgba(138, 58, 74, 0.4);
        }

        .timer-btn.stop:hover:not(:disabled), .timer-btn.stop:active:not(:disabled) {
            box-shadow: 0 6px 20px rgba(138, 58, 74, 0.6);
        }

        /* Charts */
        .chart-container {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px 15px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        @media (min-width: 768px) {
            .chart-container {
                padding: 25px;
                margin-bottom: 25px;
            }
        }

        .chart-filters {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        @media (min-width: 768px) {
            .chart-filters {
                gap: 12px;
                margin-bottom: 25px;
            }
        }

        .filter-btn {
            background: rgba(102, 126, 234, 0.3);
            border: 2px solid rgba(102, 126, 234, 0.5);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
            touch-action: manipulation;
            min-height: 40px;
        }

        @media (min-width: 768px) {
            .filter-btn {
                padding: 10px 22px;
                font-size: 14px;
            }
        }

        .filter-btn:hover, .filter-btn:active {
            background: rgba(102, 126, 234, 0.5);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            border-color: transparent;
        }

        canvas {
            max-height: 300px;
            width: 100% !important;
            height: auto !important;
        }

        @media (min-width: 768px) {
            canvas {
                max-height: 350px;
            }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(135deg, #0a0a14, #14141e);
            padding: 25px 20px;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        @media (min-width: 768px) {
            .modal-content {
                padding: 35px;
            }
        }

        .modal-content h2 {
            margin-bottom: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: clamp(20px, 4vw, 28px);
        }

        .modal-content input {
            width: 100%;
            padding: 15px;
            margin-bottom: 15px;
            border: 2px solid rgba(102, 126, 234, 0.5);
            background: rgba(10, 10, 20, 0.9);
            color: white;
            border-radius: 12px;
            font-size: 16px;
        }

        .modal-content input:focus {
            outline: none;
            border-color: #667eea;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 20px;
        }

        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-height: 45px;
            min-width: 100px;
        }

        @media (min-width: 768px) {
            .modal-btn {
                padding: 12px 30px;
            }
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            color: white;
        }

        .modal-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .modal-btn:hover, .modal-btn:active {
            transform: translateY(-2px);
        }

        /* About Panel */
        .about-content {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 25px 20px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            line-height: 1.8;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        @media (min-width: 768px) {
            .about-content {
                padding: 35px;
            }
        }

        .about-content h2 {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            font-size: clamp(24px, 4vw, 36px);
        }

        .feature-list {
            list-style: none;
            padding: 0;
        }

        .feature-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
            font-size: 14px;
        }

        @media (min-width: 768px) {
            .feature-list li {
                font-size: 16px;
            }
        }

        .feature-list li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #43e97b;
            font-weight: bold;
            font-size: 20px;
        }

        /* Login Screen */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #000000, #0a0a0a, #111111);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }

        .login-container {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(102, 126, 234, 0.2);
            max-width: 400px;
            width: 100%;
        }

        .login-title {
            font-size: clamp(36px, 8vw, 48px);
            font-weight: 900;
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-align: center;
        }

        .login-subtitle {
            color: #43e97b;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        .login-tab {
            flex: 1;
            padding: 12px;
            background: rgba(61, 78, 138, 0.3);
            border: 2px solid rgba(61, 78, 138, 0.5);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .login-tab.active {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            border-color: transparent;
        }

        .login-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 15px;
            background: rgba(10, 10, 20, 0.9);
            border: 2px solid rgba(102, 126, 234, 0.5);
            color: white;
            border-radius: 10px;
            font-size: 16px;
        }

        .login-input:focus {
            outline: none;
            border-color: #3d4e8a;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #2a6e4a 0%, #1a5a5a 100%);
            border: none;
            color: white;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 50px;
        }

        .login-btn:hover, .login-btn:active {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(42, 110, 74, 0.6);
        }

        .login-error {
            color: #ff6b6b;
            text-align: center;
            margin-top: 15px;
            font-size: 14px;
        }

        /* Rankings Table */
        .rankings-table {
            width: 100%;
            background: rgba(10, 10, 20, 0.5);
            border-radius: 15px;
            overflow: hidden;
        }

        .rankings-row {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid rgba(61, 78, 138, 0.2);
            transition: all 0.3s ease;
        }

        @media (min-width: 768px) {
            .rankings-row {
                padding: 15px 20px;
            }
        }

        .rankings-row:hover {
            background: rgba(61, 78, 138, 0.2);
        }

        .rankings-row.header {
            background: rgba(61, 78, 138, 0.3);
            font-weight: 600;
            color: #43e97b;
        }

        .rankings-row.current-user {
            background: rgba(67, 233, 123, 0.1);
            border: 2px solid rgba(67, 233, 123, 0.3);
        }

        .rank-position {
            width: 60px;
            font-size: 20px;
            font-weight: bold;
        }

        @media (min-width: 768px) {
            .rank-position {
                font-size: 24px;
            }
        }

        .rank-position.top1 { color: #ffd700; }
        .rank-position.top2 { color: #c0c0c0; }
        .rank-position.top3 { color: #cd7f32; }

        .rank-username {
            flex: 1;
            font-size: 16px;
        }

        @media (min-width: 768px) {
            .rank-username {
                font-size: 18px;
            }
        }

        .rank-time {
            width: 120px;
            text-align: right;
            font-size: 14px;
            color: #8a4a7a;
            font-weight: 600;
        }

        @media (min-width: 768px) {
            .rank-time {
                width: 150px;
                font-size: 16px;
            }
        }

        /* Admin Table */
        .admin-table {
            width: 100%;
            background: rgba(10, 10, 20, 0.5);
            border-radius: 15px;
            overflow-x: auto;
        }

        .admin-row {
            display: grid;
            grid-template-columns: 50px 1fr 150px 100px;
            gap: 12px;
            padding: 12px 15px;
            border-bottom: 1px solid rgba(61, 78, 138, 0.2);
            font-size: 13px;
        }

        @media (min-width: 768px) {
            .admin-row {
                grid-template-columns: 60px 1fr 180px 120px;
                gap: 15px;
                padding: 15px 20px;
                font-size: 14px;
            }
        }

        .admin-row.header {
            background: rgba(61, 78, 138, 0.3);
            font-weight: 600;
            color: #43e97b;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #2a6e4a 0%, #1a5a5a 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            z-index: 9999;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
            max-width: 300px;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Magical Cursor Trail Effect */
        .emoji-trail {
            position: fixed;
            pointer-events: none;
            font-size: 20px;
            z-index: 9998;
            animation: floatAway 2s ease-out forwards;
            user-select: none;
        }

        @keyframes floatAway {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1) rotate(0deg);
            }
            50% {
                opacity: 0.8;
                transform: translateY(-30px) scale(1.2) rotate(180deg);
            }
            100% {
                opacity: 0;
                transform: translateY(-80px) scale(0.5) rotate(360deg);
            }
        }

        /* Mobile Optimizations */
        @media (max-width: 767px) {
            .timer-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .timer-btn {
                width: 100%;
                max-width: 250px;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .goal-progress {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
        }

        /* Swipe Gesture Support */
        .panel {
            touch-action: pan-y;
        }

        /* Home Panel Stats */
        .home-stats-container {
            background: rgba(10, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .home-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .home-stat-card {
            background: rgba(61, 78, 138, 0.3);
            padding: 15px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(61, 78, 138, 0.5);
        }

        .home-stat-card h3 {
            font-size: 14px;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .home-stat-card .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #43e97b;
        }

        .home-stat-card .stat-label {
            font-size: 12px;
            opacity: 0.7;
        }

        /* Enhanced Floating Navigation */
        .floating-nav {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            background: rgba(10, 10, 20, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 12px 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(102, 126, 234, 0.3);
            z-index: 1000;
            display: none;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .floating-nav.active {
            display: block;
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(100px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        .floating-nav-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .floating-nav-btn {
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            border: none;
            color: white;
            padding: 12px 8px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            min-height: 60px;
            justify-content: center;
        }

        .floating-nav-btn.active {
            background: linear-gradient(135deg, #8a4a7a 0%, #7a2e3e 100%);
            transform: scale(0.95);
            box-shadow: inset 0 4px 10px rgba(0, 0, 0, 0.3);
        }

        .floating-nav-btn .icon {
            font-size: 18px;
            transition: all 0.3s ease;
        }

        .floating-nav-btn:hover, .floating-nav-btn:active {
            transform: translateY(-2px);
        }

        .floating-nav-btn.active .icon {
            transform: scale(1.2);
        }

        /* Floating Action Button */
        .fab-container {
            position: fixed;
            bottom: 25px;
            right: 25px;
            z-index: 1001;
        }

        .fab-main {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #3d4e8a 0%, #4a2c61 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
            border: 3px solid rgba(67, 233, 123, 0.3);
            font-size: 28px;
            color: white;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1002;
            position: relative;
        }

        .fab-main:hover, .fab-main.active {
            transform: scale(1.1) rotate(180deg);
            box-shadow: 0 0 40px rgba(67, 233, 123, 0.8);
        }

        .fab-options {
            position: absolute;
            bottom: 85px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .fab-options.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .fab-option {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, var(--color1), var(--color2));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.2);
            font-size: 20px;
            color: white;
            transition: all 0.3s ease;
            position: relative;
            transform: scale(0);
        }

        .fab-option.active {
            transform: scale(1);
        }

        .fab-option:nth-child(1) { --color1: #3d4e8a; --color2: #4a2c61; transition-delay: 0.05s; }
        .fab-option:nth-child(2) { --color1: #8a4a7a; --color2: #7a2e3e; transition-delay: 0.1s; }
        .fab-option:nth-child(3) { --color1: #2a5a7a; --color2: #1a6a7a; transition-delay: 0.15s; }
        .fab-option:nth-child(4) { --color1: #2a6e4a; --color2: #1a5a5a; transition-delay: 0.2s; }
        .fab-option:nth-child(5) { --color1: #8a3a4a; --color2: #7a5a2a; transition-delay: 0.25s; }
        .fab-option:nth-child(6) { --color1: #1a5a5a; --color2: #2a1a4a; transition-delay: 0.3s; }
        .fab-option:nth-child(7) { --color1: #667eea; --color2: #764ba2; transition-delay: 0.35s; }

        .fab-option:hover {
            transform: scale(1.15) !important;
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.4);
            z-index: 1003;
        }

        .fab-tooltip {
            position: absolute;
            right: 70px;
            background: rgba(10, 10, 20, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .fab-option:hover .fab-tooltip {
            opacity: 1;
        }

        /* Hide regular nav on mobile */
        @media (max-width: 767px) {
            nav {
                display: none;
            }
            
            .floating-nav {
                display: block;
            }
        }

        /* Show regular nav on desktop */
        @media (min-width: 768px) {
            nav {
                display: block;
            }
            
            .floating-nav, .fab-container {
                display: none;
            }
        }

        /* Code Protection Styles */
        .no-select {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .no-context {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .anti-inspect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 999999;
            display: none;
        }
    </style>
</head>
<body class="no-select no-context">
    <!-- Anti-Inspect Overlay -->
    <div class="anti-inspect" id="antiInspect"></div>
    
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <h1 class="login-title">‚ö° Focus ‚ö°</h1>
            <p class="login-subtitle">Never Give Up‚ö°</p>
            
            <div class="login-tabs">
                <button class="login-tab active" onclick="switchLoginTab('login')">Login</button>
                <button class="login-tab" onclick="switchLoginTab('signup')">Sign Up</button>
            </div>
            
            <div id="loginForm" class="login-form">
                <input type="text" id="loginUsername" placeholder="Username" class="login-input" />
                <input type="password" id="loginPassword" placeholder="Password" class="login-input" />
                <div style="margin: 15px 0; display: flex; align-items: center;">
                    <input type="checkbox" id="rememberMe" style="width: 20px; height: 20px; margin-right: 10px;" checked />
                    <label for="rememberMe" style="color: #43e97b; font-size: 14px;">Stay logged in for 24 hours</label>
                </div>
                <button class="login-btn" onclick="handleLogin()">üîê Login</button>
                <p class="login-error" id="loginError"></p>
            </div>
            
            <div id="signupForm" class="login-form" style="display: none;">
                <input type="text" id="signupUsername" placeholder="Choose Username" class="login-input" />
                <input type="password" id="signupPassword" placeholder="Choose Password" class="login-input" />
                <input type="password" id="signupPasswordConfirm" placeholder="Confirm Password" class="login-input" />
                <div style="margin: 15px 0; display: flex; align-items: center;">
                    <input type="checkbox" id="rememberMeSignup" style="width: 20px; height: 20px; margin-right: 10px;" checked />
                    <label for="rememberMeSignup" style="color: #43e97b; font-size: 14px;">Stay logged in for 24 hours</label>
                </div>
                <button class="login-btn" onclick="handleSignup()">‚ú® Create Account</button>
                <p class="login-error" id="signupError"></p>
            </div>
        </div>
    </div>

    <div class="container" id="mainApp" style="display: none;">
        <!-- Enhanced Floating Navigation for Mobile -->
        <div class="floating-nav" id="floatingNav">
            <div class="floating-nav-grid">
                <button class="floating-nav-btn active" data-panel="home">
                    <span class="icon">üè†</span>
                    <span>Home</span>
                </button>
                <button class="floating-nav-btn" data-panel="pomodoro">
                    <span class="icon">üçÖ</span>
                    <span>Timer</span>
                </button>
                <button class="floating-nav-btn" data-panel="graphs">
                    <span class="icon">üìä</span>
                    <span>Charts</span>
                </button>
                <button class="floating-nav-btn" data-panel="streaks">
                    <span class="icon">üî•</span>
                    <span>Streaks</span>
                </button>
                <button class="floating-nav-btn" data-panel="rankings">
                    <span class="icon">üèÜ</span>
                    <span>Rank</span>
                </button>
                <button class="floating-nav-btn" data-panel="about">
                    <span class="icon">‚ÑπÔ∏è</span>
                    <span>About</span>
                </button>
                <button class="floating-nav-btn" data-panel="admin" id="mobileAdminBtn" style="display: none;">
                    <span class="icon">‚öôÔ∏è</span>
                    <span>Admin</span>
                </button>
                <button class="floating-nav-btn" onclick="toggleFloatingMenu()" style="background: linear-gradient(135deg, #8a3a4a 0%, #7a5a2a 100%);">
                    <span class="icon" id="menuIcon">‚ö°</span>
                    <span>Menu</span>
                </button>
                <button class="floating-nav-btn" onclick="handleLogout()" style="background: linear-gradient(135deg, #8a3a4a 0%, #7a5a2a 100%);">
                    <span class="icon">üö™</span>
                    <span>Logout</span>
                </button>
            </div>
        </div>
        
        <!-- Floating Action Button for Quick Access -->
        <div class="fab-container">
            <div class="fab-main" id="fabMain" onclick="toggleFabMenu()">
                ‚ö°
            </div>
            <div class="fab-options" id="fabOptions">
                <!-- Options will be added dynamically -->
            </div>
        </div>
        
        <!-- Header -->
        <div class="header">
            <h1 class="site-title">‚ö° Focus ‚ö°</h1>
            <p class="site-subtitle">Never Give Up‚ö°</p>
        </div>
        
        <!-- Navigation (Hidden on Mobile) -->
        <nav>
            <div class="nav-buttons">
                <button class="nav-btn active" data-panel="home">üè† HOME</button>
                <button class="nav-btn" data-panel="pomodoro">üçÖ POMODORO</button>
                <button class="nav-btn" data-panel="graphs">üìä GRAPHS</button>
                <button class="nav-btn" data-panel="streaks">üî• STREAKS</button>
                <button class="nav-btn" data-panel="rankings">üèÜ RANKINGS</button>
                <button class="nav-btn" data-panel="about">‚ÑπÔ∏è ABOUT</button>
                <button class="nav-btn" id="adminBtn" data-panel="admin" style="display: none;">‚öôÔ∏è ADMIN</button>
                <button class="logout-btn" onclick="handleLogout()">üö™ Logout</button>
            </div>
        </nav>

        <!-- HOME Panel -->
        <div class="panel active" id="home">
            <!-- Quick Stats Section -->
            <div class="home-stats-container">
                <h2 style="font-size: clamp(18px, 3vw, 24px); margin-bottom: 15px; text-align: center;">üìä Today's Overview</h2>
                <div class="home-stats-grid">
                    <div class="home-stat-card">
                        <h3>üçÖ Pomodoros</h3>
                        <div class="stat-value" id="homePomodoroStat">0</div>
                        <div class="stat-label">Completed Today</div>
                    </div>
                    <div class="home-stat-card">
                        <h3>üî• Streak</h3>
                        <div class="stat-value" id="homeStreakStat">0</div>
                        <div class="stat-label">Days</div>
                    </div>
                    <div class="home-stat-card">
                        <h3>‚è±Ô∏è Study Time</h3>
                        <div class="stat-value" id="homeTimeStat">0h</div>
                        <div class="stat-label">Today</div>
                    </div>
                    <div class="home-stat-card">
                        <h3>üìö Subjects</h3>
                        <div class="stat-value" id="homeSubjectsStat">0</div>
                        <div class="stat-label">Active</div>
                    </div>
                </div>
            </div>

            <!-- Subjects Section -->
            <div class="subjects-container" id="subjectsContainer">
                <!-- Subjects will be added dynamically -->
            </div>
            <button class="add-subject-btn" onclick="openAddSubjectModal()">‚ûï Add Subject</button>
            
            <!-- Home Timer Section -->
            <div class="timer-section" style="margin-top: 30px;">
                <div class="timer-header">
                    <h2 style="font-size: clamp(18px, 3vw, 24px);">‚è±Ô∏è Quick Timer</h2>
                    <div class="pomodoro-counter">
                        <span id="homePomodoroCount">Today: 0</span>
                    </div>
                </div>
                <div id="homeCurrentSubject" style="font-size: clamp(16px, 2.5vw, 20px); margin-bottom: 10px; opacity: 0.9; min-height: 24px;">
                    Select a subject to start
                </div>
                <div class="timer-display" id="homeTimerDisplay">00:00</div>
                <div class="timer-controls">
                    <button class="timer-btn" id="homeStartStopBtn" onclick="toggleHomeTimer()" disabled>‚ñ∂Ô∏è START</button>
                </div>
            </div>
        </div>

        <!-- POMODORO Panel -->
        <div class="panel" id="pomodoro">
            <!-- Daily Goal System -->
            <div class="daily-goal-container">
                <div class="goal-header">
                    <h2>üéØ Daily Goal</h2>
                    <div class="goal-controls">
                        <button class="goal-btn" onclick="adjustGoal(-1)">-</button>
                        <button class="goal-btn" onclick="adjustGoal(1)">+</button>
                        <button class="goal-btn" onclick="resetDailyGoal()">üîÑ</button>
                    </div>
                </div>
                <div class="goal-progress">
                    <div class="progress-ring-container">
                        <svg class="progress-ring" id="progressRing">
                            <circle class="progress-ring-bg" cx="50" cy="50" r="46"></circle>
                            <circle class="progress-ring-fill" cx="50" cy="50" r="46"></circle>
                        </svg>
                        <div class="progress-text">
                            <div class="completed" id="completedPomodoros">0</div>
                            <div class="target" id="targetPomodoros">/4</div>
                        </div>
                    </div>
                    <div class="goal-stats">
                        <div class="goal-stat">üéØ Daily Target: <span id="dailyTarget">4</span> Pomodoros</div>
                        <div class="goal-stat">‚úÖ Completed: <span id="completedToday">0</span> Pomodoros</div>
                        <div class="goal-stat">üìä Progress: <span id="progressPercentage">0%</span></div>
                        <div class="goal-stat">üî• Current Streak: <span id="currentStreak">0</span> days</div>
                    </div>
                </div>
            </div>

            <!-- Main Timer Section -->
            <div class="timer-section">
                <div class="timer-header">
                    <h2 style="font-size: clamp(20px, 4vw, 32px);">üçÖ Pomodoro Timer</h2>
                    <div class="pomodoro-counter">
                        <span id="pomodoroSessionCount">Sessions: 0</span>
                    </div>
                </div>
                <div id="currentSubject" style="font-size: clamp(18px, 3vw, 24px); margin-bottom: 15px; opacity: 0.9;">üìö No subject selected</div>
                <div class="timer-display" id="timerDisplay">25:00</div>
                <div class="timer-controls">
                    <button class="timer-btn" id="startBtn" onclick="startTimer()" disabled>‚ñ∂Ô∏è START</button>
                    <button class="timer-btn stop" id="stopBtn" onclick="stopTimer()" disabled>‚èπÔ∏è STOP</button>
                    <button class="timer-btn" onclick="resetTimer()">üîÑ RESET</button>
                </div>
            </div>
        </div>

        <!-- GRAPHS Panel -->
        <div class="panel" id="graphs">
            <div class="chart-container">
                <h2 style="font-size: clamp(20px, 4vw, 32px); margin-bottom: 20px; text-align: center;">üìä Time Distribution</h2>
                <div class="chart-filters">
                    <button class="filter-btn active" onclick="updateGraphFilter('today')">üìÖ Today</button>
                    <button class="filter-btn" onclick="updateGraphFilter('week')">üìÜ Week</button>
                    <button class="filter-btn" onclick="updateGraphFilter('month')">üóìÔ∏è Month</button>
                </div>
                <canvas id="pieChart"></canvas>
                <div id="studySummary" style="margin-top: 30px; padding: 20px; background: rgba(61, 78, 138, 0.2); border-radius: 15px; border: 1px solid rgba(61, 78, 138, 0.3);"></div>
            </div>
        </div>

        <!-- STREAKS Panel -->
        <div class="panel" id="streaks">
            <div class="chart-container">
                <h2 style="font-size: clamp(20px, 4vw, 32px); margin-bottom: 20px; text-align: center;">üî• Study Streaks</h2>
                <div class="chart-filters">
                    <button class="filter-btn active" onclick="updateStreakFilter('day')">‚òÄÔ∏è Day</button>
                    <button class="filter-btn" onclick="updateStreakFilter('week')">üìÜ Week</button>
                    <button class="filter-btn" onclick="updateStreakFilter('month')">üóìÔ∏è Month</button>
                </div>
                <canvas id="barChart"></canvas>
            </div>
        </div>

        <!-- RANKINGS Panel -->
        <div class="panel" id="rankings">
            <div class="chart-container">
                <h2 style="font-size: clamp(20px, 4vw, 32px); margin-bottom: 20px; text-align: center;">üèÜ Global Rankings</h2>
                <div class="chart-filters">
                    <button class="filter-btn active" onclick="updateRankingFilter('today')">üìÖ Today</button>
                    <button class="filter-btn" onclick="updateRankingFilter('week')">üìÜ Week</button>
                    <button class="filter-btn" onclick="updateRankingFilter('month')">üóìÔ∏è Month</button>
                    <button class="filter-btn" onclick="updateRankingFilter('alltime')">üåü All Time</button>
                </div>
                <div id="rankingsTable" style="margin-top: 30px;"></div>
            </div>
        </div>

        <!-- ADMIN Panel -->
        <div class="panel" id="admin">
            <div class="chart-container">
                <h2 style="font-size: clamp(20px, 4vw, 32px); margin-bottom: 20px; text-align: center;">‚öôÔ∏è Admin Panel</h2>
                <div style="background: rgba(138, 74, 122, 0.2); padding: 20px; border-radius: 15px; border: 1px solid rgba(138, 74, 122, 0.3); margin-bottom: 20px;">
                    <h3 style="color: #43e97b; margin-bottom: 15px;">üìä User Statistics</h3>
                    <p id="adminStats" style="line-height: 2;"></p>
                </div>
                <div id="adminUsersTable" style="margin-top: 30px;"></div>
            </div>
        </div>

        <!-- ABOUT Panel -->
        <div class="panel" id="about">
            <div class="about-content">
                <h2>‚ÑπÔ∏è About Focus</h2>
                <p style="margin-bottom: 20px;">A comprehensive study tracking application designed to boost your productivity using the Pomodoro Technique. üöÄ</p>
                
                <h3 style="margin-top: 30px; margin-bottom: 15px; color: #3d4e8a;">‚ú® Features:</h3>
                <ul class="feature-list">
                    <li>Professional dark mode dashboard with smooth animations üåô</li>
                    <li>Daily Pomodoro goals with progress ring visualization üéØ</li>
                    <li>Customizable subject management with todo lists üìù</li>
                    <li>25-minute Pomodoro timer with session counter ‚è±Ô∏è</li>
                    <li>Visual analytics with pie and bar charts üìà</li>
                    <li>Time tracking across multiple periods (day, week, month) üìä</li>
                    <li>Streak tracking to maintain consistency üî•</li>
                    <li>Mobile-friendly responsive design with touch optimization üì±</li>
                    <li>Global rankings to compare progress with others üèÜ</li>
                </ul>

                <h3 style="margin-top: 30px; margin-bottom: 15px; color: #3d4e8a;">üìñ How to Use:</h3>
                <ul class="feature-list">
                    <li>Add your subjects from the HOME panel üìù</li>
                    <li>Select a subject to activate the timer ‚úÖ</li>
                    <li>Set your daily Pomodoro goal (default: 4 sessions) üéØ</li>
                    <li>Start the timer and focus for 25-minute sessions üçÖ</li>
                    <li>Add todo items to each subject to track tasks üìã</li>
                    <li>Track your progress in the GRAPHS and STREAKS panels üìâ</li>
                    <li>Complete your daily goal to maintain streaks! üî•</li>
                </ul>

                <h3 style="margin-top: 30px; margin-bottom: 15px; color: #3d4e8a;">üë®‚Äçüíª Developer:</h3>
                <div style="background: rgba(61, 78, 138, 0.2); padding: 20px; border-radius: 15px; border: 1px solid rgba(61, 78, 138, 0.3); margin-top: 15px;">
                    <p style="margin: 8px 0;"><strong style="color: #43e97b;">Name:</strong> Ometh V.</p>
                    <p style="margin: 8px 0;"><strong style="color: #43e97b;">From:</strong> Sri Lanka üá±üá∞</p>
                    <p style="margin: 8px 0;"><strong style="color: #43e97b;">Version:</strong> 1.5</p>
                    <p style="margin: 8px 0;"><strong style="color: #43e97b;">GitHub:</strong> <a href="https://github.com/ometh2006" target="_blank" style="color: #8a4a7a; text-decoration: none; border-bottom: 1px solid #8a4a7a;">github.com/ometh2006</a></p>
                    <p style="margin: 8px 0;"><strong style="color: #43e97b;">Telegram:</strong> <a href="https://t.me/OMETH_PM_BOT" target="_blank" style="color: #8a4a7a; text-decoration: none; border-bottom: 1px solid #8a4a7a;">@OMETH_PM_BOT</a></p>
                    <p style="margin-top: 15px; font-style: italic; opacity: 0.9;">"Never Give Up‚ö° - Keep pushing forward and achieve your dreams!"</p>
                </div>

                <div style="margin-top: 30px; text-align: center; padding: 15px; background: rgba(138, 74, 122, 0.2); border-radius: 10px; border: 1px solid rgba(138, 74, 122, 0.3);">
                    <p style="font-size: 14px; opacity: 0.9;">Made with ‚ù§Ô∏è for students worldwide</p>
                    <p style="font-size: 12px; margin-top: 5px; opacity: 0.7;">¬© 2026 Focus Study Tracker v1.5</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Subject Modal -->
    <div class="modal" id="addSubjectModal">
        <div class="modal-content">
            <h2>‚ûï Add New Subject</h2>
            <input type="text" id="subjectNameInput" placeholder="Enter subject name..." />
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeAddSubjectModal()">‚ùå Cancel</button>
                <button class="modal-btn primary" onclick="addSubject()">‚úÖ Add</button>
            </div>
        </div>
    </div>

    <!-- Add Todo Modal -->
    <div class="modal" id="addTodoModal">
        <div class="modal-content">
            <h2>üìù Add Todo</h2>
            <input type="text" id="todoInput" placeholder="Enter todo item..." />
            <div class="modal-buttons">
                <button class="modal-btn secondary" onclick="closeTodoModal()">‚ùå Cancel</button>
                <button class="modal-btn primary" onclick="addTodo()">‚úÖ Add</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast"></div>

    <script>
        // ========== CODE PROTECTION SYSTEM ==========
        (function() {
            // Disable right-click
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                showTemporaryToast('üö´ Right-click is disabled', 2000);
            });
            
            // Disable keyboard shortcuts for dev tools
            document.addEventListener('keydown', function(e) {
                // Disable F12
                if (e.key === 'F12') {
                    e.preventDefault();
                    showTemporaryToast('üö´ Developer tools are disabled', 2000);
                    return false;
                }
                
                // Disable Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C, Ctrl+U
                if (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key)) {
                    e.preventDefault();
                    showTemporaryToast('üö´ Developer tools are disabled', 2000);
                    return false;
                }
                
                // Disable Ctrl+U (view source)
                if (e.ctrlKey && e.key === 'u') {
                    e.preventDefault();
                    showTemporaryToast('üö´ View source is disabled', 2000);
                    return false;
                }
                
                // Disable Ctrl+S (save page)
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    showTemporaryToast('üö´ Page saving is disabled', 2000);
                    return false;
                }
            });
            
            // Detect dev tools opening
            let devToolsOpen = false;
            const threshold = 160;
            
            const checkDevTools = function() {
                const widthThreshold = window.outerWidth - window.innerWidth > threshold;
                const heightThreshold = window.outerHeight - window.innerHeight > threshold;
                const orientation = widthThreshold || heightThreshold;
                
                if (orientation && !devToolsOpen) {
                    devToolsOpen = true;
                    showTemporaryToast('‚ö†Ô∏è Developer tools detected - Some features may not work properly', 3000);
                } else if (!orientation && devToolsOpen) {
                    devToolsOpen = false;
                }
            };
            
            // Check periodically
            setInterval(checkDevTools, 1000);
            
            // Override console methods
            const originalConsole = {
                log: console.log,
                warn: console.warn,
                error: console.error,
                info: console.info,
                debug: console.debug
            };
            
            console.log = function() {};
            console.warn = function() {};
            console.error = function() {};
            console.info = function() {};
            console.debug = function() {};
            
            // Hide code on view source attempts
            window.onbeforeunload = function() {
                document.body.innerHTML = '';
            };
            
            // Show temporary toast
            function showTemporaryToast(message, duration) {
                const tempToast = document.createElement('div');
                tempToast.className = 'toast';
                tempToast.textContent = message;
                tempToast.style.cssText = `
                    position: fixed;
                    bottom: 80px;
                    right: 20px;
                    background: linear-gradient(135deg, #8a3a4a 0%, #7a5a2a 100%);
                    color: white;
                    padding: 15px 20px;
                    border-radius: 15px;
                    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
                    z-index: 10000;
                    animation: toastSlide 0.3s ease;
                `;
                
                document.body.appendChild(tempToast);
                
                setTimeout(() => {
                    tempToast.style.animation = 'toastSlideOut 0.3s ease forwards';
                    setTimeout(() => {
                        if (tempToast.parentNode) {
                            tempToast.parentNode.removeChild(tempToast);
                        }
                    }, 300);
                }, duration);
                
                // Add CSS for animation
                if (!document.getElementById('toastStyles')) {
                    const style = document.createElement('style');
                    style.id = 'toastStyles';
                    style.textContent = `
                        @keyframes toastSlide {
                            from {
                                transform: translateX(100%);
                                opacity: 0;
                            }
                            to {
                                transform: translateX(0);
                                opacity: 1;
                            }
                        }
                        @keyframes toastSlideOut {
                            from {
                                transform: translateX(0);
                                opacity: 1;
                            }
                            to {
                                transform: translateX(100%);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            }
        })();
        
        // ========== MAIN APPLICATION CODE ==========
        // Login & User Management
        let currentUser = null;
        let allUsers = JSON.parse(localStorage.getItem('allUsers')) || {};
        let currentRankingFilter = 'today';
        
        // Auto-login session data
        const SESSION_KEY = 'focus_study_session';
        const SESSION_DURATION = 24 * 60 * 60 * 1000; // 24 hours
        
        // Initialize admin account
        if (!allUsers['ometh']) {
            allUsers['ometh'] = {
                username: 'ometh',
                password: '#Ometh2006',
                isAdmin: true,
                joinedDate: new Date().toISOString(),
                subjects: [],
                studyData: {},
                dailyGoal: 4,
                completedPomodoros: {},
                todos: {},
                pomodoroSessions: 0,
                streak: 0,
                lastActiveDate: new Date().toISOString().split('T')[0]
            };
            localStorage.setItem('allUsers', JSON.stringify(allUsers));
        }

        // State Management
        let subjects = [];
        let selectedSubject = null;
        let timerInterval = null;
        let timeRemaining = 25 * 60;
        let isRunning = false;
        let studyData = {};
        let currentGraphFilter = 'today';
        let currentStreakFilter = 'week';
        let dailyGoal = 4;
        let completedPomodorosToday = 0;
        let todos = {};
        let pomodoroSessions = 0;
        let streak = 0;
        let lastActiveDate = '';
        
        // Home timer state
        let homeTimerInterval = null;
        let homeTimeElapsed = 0;
        let homeTimerRunning = false;
        
        // Current subject for todo modal
        let currentTodoSubject = null;

        // Check for valid session on page load
        window.addEventListener('DOMContentLoaded', () => {
            checkAutoLogin();
        });

        // Auto-login function
        function checkAutoLogin() {
            const sessionData = JSON.parse(localStorage.getItem(SESSION_KEY));
            
            if (sessionData && sessionData.username && sessionData.expiry) {
                const now = new Date().getTime();
                
                if (now < sessionData.expiry && allUsers[sessionData.username]) {
                    currentUser = sessionData.username;
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    initializeUserData();
                    showToast(`Welcome back, ${currentUser}!`, 2000);
                    createFabMenu(); // Initialize FAB menu
                } else {
                    localStorage.removeItem(SESSION_KEY);
                }
            }
        }

        // Create session
        function createSession(username, remember = true) {
            if (remember) {
                const sessionData = {
                    username: username,
                    expiry: new Date().getTime() + SESSION_DURATION
                };
                localStorage.setItem(SESSION_KEY, JSON.stringify(sessionData));
            }
        }

        // Clear session
        function clearSession() {
            localStorage.removeItem(SESSION_KEY);
        }

        // Enhanced Floating Navigation Functions
        function createFabMenu() {
            const fabOptions = document.getElementById('fabOptions');
            fabOptions.innerHTML = '';
            
            // Define panel data
            const panelData = [
                { id: 'home', icon: 'üè†', name: 'Home', color1: '#3d4e8a', color2: '#4a2c61' },
                { id: 'pomodoro', icon: 'üçÖ', name: 'Pomodoro', color1: '#8a4a7a', color2: '#7a2e3e' },
                { id: 'graphs', icon: 'üìä', name: 'Charts', color1: '#2a5a7a', color2: '#1a6a7a' },
                { id: 'streaks', icon: 'üî•', name: 'Streaks', color1: '#2a6e4a', color2: '#1a5a5a' },
                { id: 'rankings', icon: 'üèÜ', name: 'Rankings', color1: '#8a3a4a', color2: '#7a5a2a' },
                { id: 'about', icon: '‚ÑπÔ∏è', name: 'About', color1: '#1a5a5a', color2: '#2a1a4a' }
            ];
            
            // Add admin panel if user is admin
            if (currentUser && allUsers[currentUser]?.isAdmin) {
                panelData.push({ id: 'admin', icon: '‚öôÔ∏è', name: 'Admin', color1: '#667eea', color2: '#764ba2' });
            }
            
            // Add logout option
            panelData.push({ id: 'logout', icon: 'üö™', name: 'Logout', color1: '#8a3a4a', color2: '#7a5a2a' });
            
            panelData.forEach(panel => {
                const option = document.createElement('div');
                option.className = 'fab-option';
                option.innerHTML = panel.icon;
                
                const tooltip = document.createElement('div');
                tooltip.className = 'fab-tooltip';
                tooltip.textContent = panel.name;
                option.appendChild(tooltip);
                
                option.style.setProperty('--color1', panel.color1);
                option.style.setProperty('--color2', panel.color2);
                
                option.addEventListener('click', (e) => {
                    e.stopPropagation();
                    if (panel.id === 'logout') {
                        handleLogout();
                    } else {
                        selectPanelFromFab(panel.id);
                    }
                    toggleFabMenu();
                });
                
                fabOptions.appendChild(option);
            });
        }

        function toggleFabMenu() {
            const fabOptions = document.getElementById('fabOptions');
            const fabMain = document.getElementById('fabMain');
            const isActive = fabOptions.classList.contains('active');
            
            if (isActive) {
                fabOptions.classList.remove('active');
                fabMain.classList.remove('active');
                hideFabOptions();
            } else {
                fabOptions.classList.add('active');
                fabMain.classList.add('active');
                showFabOptions();
            }
        }

        function showFabOptions() {
            const options = document.querySelectorAll('.fab-option');
            options.forEach((option, index) => {
                setTimeout(() => {
                    option.classList.add('active');
                }, index * 50);
            });
        }

        function hideFabOptions() {
            const options = document.querySelectorAll('.fab-option');
            options.forEach((option, index) => {
                setTimeout(() => {
                    option.classList.remove('active');
                }, index * 30);
            });
        }

        function selectPanelFromFab(panelId) {
            const navBtn = document.querySelector(`[data-panel="${panelId}"]`);
            if (navBtn) {
                navBtn.click();
            }
            
            // Update floating nav
            document.querySelectorAll('.floating-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const floatingBtn = document.querySelector(`.floating-nav-btn[data-panel="${panelId}"]`);
            if (floatingBtn) {
                floatingBtn.classList.add('active');
            }
        }

        function toggleFloatingMenu() {
            const menuIcon = document.getElementById('menuIcon');
            if (menuIcon.textContent === '‚ö°') {
                menuIcon.textContent = '‚úï';
                showToast('Navigation expanded', 1500);
            } else {
                menuIcon.textContent = '‚ö°';
                showToast('Navigation collapsed', 1500);
            }
        }

        // Initialize app after login
        function initializeUserData() {
            if (currentUser) {
                const userData = allUsers[currentUser];
                subjects = userData.subjects || [];
                studyData = userData.studyData || {};
                dailyGoal = userData.dailyGoal || 4;
                completedPomodorosToday = userData.completedPomodoros?.[getTodayDate()] || 0;
                todos = userData.todos || {};
                pomodoroSessions = userData.pomodoroSessions || 0;
                streak = userData.streak || 0;
                lastActiveDate = userData.lastActiveDate || '';
                
                renderSubjects();
                initCharts();
                updateCharts();
                updateDailyGoalDisplay();
                updatePomodoroCounts();
                updateStreak();
                updateHomeStats();
                
                // Show admin buttons if admin
                if (userData.isAdmin) {
                    document.getElementById('adminBtn').style.display = 'inline-block';
                    document.getElementById('mobileAdminBtn').style.display = 'flex';
                }
                
                // Initialize FAB menu
                if (window.innerWidth <= 767) {
                    createFabMenu();
                }
            }
        }

        // Save user data
        function saveUserData() {
            if (currentUser) {
                allUsers[currentUser].subjects = subjects;
                allUsers[currentUser].studyData = studyData;
                allUsers[currentUser].dailyGoal = dailyGoal;
                allUsers[currentUser].completedPomodoros = allUsers[currentUser].completedPomodoros || {};
                allUsers[currentUser].completedPomodoros[getTodayDate()] = completedPomodorosToday;
                allUsers[currentUser].todos = todos;
                allUsers[currentUser].pomodoroSessions = pomodoroSessions;
                allUsers[currentUser].streak = streak;
                allUsers[currentUser].lastActiveDate = getTodayDate();
                
                localStorage.setItem('allUsers', JSON.stringify(allUsers));
            }
        }

        // Utility functions
        function getTodayDate() {
            return new Date().toISOString().split('T')[0];
        }

        function showToast(message, duration = 3000) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, duration);
        }

        // Update home panel statistics
        function updateHomeStats() {
            document.getElementById('homePomodoroStat').textContent = completedPomodorosToday;
            document.getElementById('homeStreakStat').textContent = streak;
            
            const today = getTodayDate();
            let totalMinutesToday = 0;
            if (studyData[today]) {
                Object.values(studyData[today]).forEach(minutes => {
                    totalMinutesToday += minutes;
                });
            }
            const hours = Math.floor(totalMinutesToday / 60);
            const minutes = totalMinutesToday % 60;
            const timeText = hours > 0 ? `${hours}h` : `${minutes}m`;
            document.getElementById('homeTimeStat').textContent = timeText;
            
            document.getElementById('homeSubjectsStat').textContent = subjects.length;
        }

        // Daily Goal Functions
        function updateDailyGoalDisplay() {
            document.getElementById('dailyTarget').textContent = dailyGoal;
            document.getElementById('completedToday').textContent = completedPomodorosToday;
            document.getElementById('completedPomodoros').textContent = completedPomodorosToday;
            document.getElementById('targetPomodoros').textContent = '/' + dailyGoal;
            
            const percentage = Math.min(100, Math.round((completedPomodorosToday / dailyGoal) * 100));
            document.getElementById('progressPercentage').textContent = percentage + '%';
            
            const circumference = 2 * Math.PI * 46;
            const offset = circumference - (percentage / 100) * circumference;
            const progressRing = document.querySelector('.progress-ring-fill');
            progressRing.style.strokeDasharray = `${circumference} ${circumference}`;
            progressRing.style.strokeDashoffset = offset;
            
            document.getElementById('currentStreak').textContent = streak;
            updateHomeStats();
        }

        function adjustGoal(change) {
            const newGoal = dailyGoal + change;
            if (newGoal >= 1 && newGoal <= 20) {
                dailyGoal = newGoal;
                updateDailyGoalDisplay();
                saveUserData();
                showToast(`Daily goal set to ${dailyGoal} Pomodoros`);
            }
        }

        function resetDailyGoal() {
            if (confirm('Reset completed Pomodoros for today?')) {
                completedPomodorosToday = 0;
                updateDailyGoalDisplay();
                saveUserData();
                showToast('Daily progress reset');
            }
        }

        function completePomodoro() {
            completedPomodorosToday++;
            pomodoroSessions++;
            updateDailyGoalDisplay();
            updatePomodoroCounts();
            saveUserData();
            
            if (completedPomodorosToday >= dailyGoal) {
                showToast('üéâ Daily goal completed! Keep up the great work!', 5000);
            }
            
            updateStreak();
        }

        function updateStreak() {
            const today = getTodayDate();
            if (lastActiveDate !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayStr = yesterday.toISOString().split('T')[0];
                
                if (lastActiveDate === yesterdayStr) {
                    streak++;
                    showToast(`üî• Streak updated! Current streak: ${streak} days`, 3000);
                } else if (completedPomodorosToday > 0 && lastActiveDate !== today) {
                    streak = 1;
                }
                
                lastActiveDate = today;
                saveUserData();
                updateDailyGoalDisplay();
            }
        }

        function updatePomodoroCounts() {
            document.getElementById('homePomodoroCount').textContent = `Today: ${completedPomodorosToday}`;
            document.getElementById('pomodoroSessionCount').textContent = `Sessions: ${pomodoroSessions}`;
        }

        // Todo List Functions
        function openTodoModal(subject) {
            currentTodoSubject = subject;
            document.getElementById('addTodoModal').classList.add('active');
            document.getElementById('todoInput').focus();
        }

        function closeTodoModal() {
            document.getElementById('addTodoModal').classList.remove('active');
            document.getElementById('todoInput').value = '';
            currentTodoSubject = null;
        }

        function addTodo() {
            const input = document.getElementById('todoInput');
            const text = input.value.trim();
            
            if (text && currentTodoSubject) {
                if (!todos[currentTodoSubject]) {
                    todos[currentTodoSubject] = [];
                }
                
                todos[currentTodoSubject].push({
                    text: text,
                    completed: false,
                    createdAt: new Date().toISOString()
                });
                
                saveUserData();
                renderSubjects();
                closeTodoModal();
                showToast('‚úÖ Todo added');
            }
        }

        function toggleTodo(subject, index) {
            if (todos[subject] && todos[subject][index]) {
                todos[subject][index].completed = !todos[subject][index].completed;
                todos[subject][index].completedAt = todos[subject][index].completed ? new Date().toISOString() : null;
                saveUserData();
                renderSubjects();
            }
        }

        function deleteTodo(subject, index) {
            if (todos[subject] && confirm('Delete this todo?')) {
                todos[subject].splice(index, 1);
                saveUserData();
                renderSubjects();
                showToast('üóëÔ∏è Todo deleted');
            }
        }

        // Login System Functions
        function switchLoginTab(tab) {
            document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
            if (tab === 'login') {
                document.querySelectorAll('.login-tab')[0].classList.add('active');
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('signupForm').style.display = 'none';
            } else {
                document.querySelectorAll('.login-tab')[1].classList.add('active');
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('signupForm').style.display = 'block';
            }
            document.getElementById('loginError').textContent = '';
            document.getElementById('signupError').textContent = '';
        }

        function handleLogin() {
            const username = document.getElementById('loginUsername').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            const errorEl = document.getElementById('loginError');

            if (!username || !password) {
                errorEl.textContent = '‚ö†Ô∏è Please fill in all fields';
                return;
            }

            if (!allUsers[username]) {
                errorEl.textContent = '‚ùå User not found';
                return;
            }

            if (allUsers[username].password !== password) {
                errorEl.textContent = '‚ùå Incorrect password';
                return;
            }

            currentUser = username;
            createSession(username, rememberMe);
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            initializeUserData();
            errorEl.textContent = '';
            showToast(`Welcome back, ${username}!`, 2000);
        }

        function handleSignup() {
            const username = document.getElementById('signupUsername').value.trim().toLowerCase();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupPasswordConfirm').value;
            const rememberMe = document.getElementById('rememberMeSignup').checked;
            const errorEl = document.getElementById('signupError');

            if (!username || !password || !confirmPassword) {
                errorEl.textContent = '‚ö†Ô∏è Please fill in all fields';
                return;
            }

            if (username.length < 3) {
                errorEl.textContent = '‚ö†Ô∏è Username must be at least 3 characters';
                return;
            }

            if (password.length < 6) {
                errorEl.textContent = '‚ö†Ô∏è Password must be at least 6 characters';
                return;
            }

            if (password !== confirmPassword) {
                errorEl.textContent = '‚ö†Ô∏è Passwords do not match';
                return;
            }

            if (allUsers[username]) {
                errorEl.textContent = '‚ö†Ô∏è Username already exists';
                return;
            }

            allUsers[username] = {
                username: username,
                password: password,
                isAdmin: false,
                joinedDate: new Date().toISOString(),
                subjects: [],
                studyData: {},
                dailyGoal: 4,
                completedPomodoros: {},
                todos: {},
                pomodoroSessions: 0,
                streak: 0,
                lastActiveDate: new Date().toISOString().split('T')[0]
            };
            localStorage.setItem('allUsers', JSON.stringify(allUsers));

            currentUser = username;
            createSession(username, rememberMe);
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            initializeUserData();
            errorEl.textContent = '';
            showToast(`Welcome to Focus, ${username}!`, 3000);
        }

        function handleLogout() {
            if (confirm('Are you sure you want to logout?')) {
                saveUserData();
                clearSession();
                currentUser = null;
                subjects = [];
                studyData = {};
                
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
                document.getElementById('loginUsername').value = '';
                document.getElementById('loginPassword').value = '';
                
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.nav-btn')[0].classList.add('active');
                document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
                document.getElementById('home').classList.add('active');
                
                document.querySelectorAll('.floating-nav-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.floating-nav-btn')[0].classList.add('active');
            }
        }

        // Initialize Navigation
        document.querySelectorAll('.nav-btn, .floating-nav-btn').forEach(btn => {
            if (btn.dataset.panel) {
                btn.addEventListener('click', () => {
                    // Update button states
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.floating-nav-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    // Update panels
                    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
                    document.getElementById(btn.dataset.panel).classList.add('active');
                    
                    // Panel-specific updates
                    if (btn.dataset.panel === 'graphs' || btn.dataset.panel === 'streaks') {
                        updateCharts();
                    }
                    
                    if (btn.dataset.panel === 'rankings') {
                        updateRankingsDisplay();
                    }
                    
                    if (btn.dataset.panel === 'admin') {
                        updateAdminPanel();
                    }
                    
                    if (btn.dataset.panel === 'pomodoro') {
                        updateDailyGoalDisplay();
                    }
                });
            }
        });

        // Subject Management
        function renderSubjects() {
            const container = document.getElementById('subjectsContainer');
            container.innerHTML = '';
            
            subjects.forEach((subject, index) => {
                const card = document.createElement('div');
                card.className = 'subject-card';
                if (selectedSubject === subject) {
                    card.classList.add('selected');
                }
                
                const todayMinutes = getTotalTimeForSubject(subject, 'today');
                const hours = Math.floor(todayMinutes / 60);
                const minutes = todayMinutes % 60;
                const totalMinutes = getTotalTimeForSubject(subject, 'all');
                const totalHours = Math.floor(totalMinutes / 60);
                const totalMins = totalMinutes % 60;
                
                const subjectTodos = todos[subject] || [];
                const completedTodos = subjectTodos.filter(t => t.completed).length;
                const totalTodos = subjectTodos.length;
                
                card.innerHTML = `
                    <button class="remove-btn" onclick="removeSubject(${index}); event.stopPropagation();">√ó</button>
                    <h3>${subject}</h3>
                    <div class="subject-stats">
                        <div class="subject-stat">‚è±Ô∏è Today: ${hours}h ${minutes}m</div>
                        <div class="subject-stat">üìä Total: ${totalHours}h ${totalMins}m</div>
                        <div class="subject-stat">üìã Todos: ${completedTodos}/${totalTodos}</div>
                    </div>
                `;
                
                if (subjectTodos.length > 0) {
                    const todoSection = document.createElement('div');
                    todoSection.className = 'todo-section';
                    todoSection.innerHTML = `
                        <div class="todo-header">
                            <h4>üìã Tasks (${completedTodos}/${totalTodos})</h4>
                            <button class="add-todo-btn" onclick="event.stopPropagation(); openTodoModal('${subject}')">+ Add</button>
                        </div>
                        <div class="todo-list">
                            ${subjectTodos.map((todo, todoIndex) => `
                                <div class="todo-item ${todo.completed ? 'completed' : ''}" onclick="event.stopPropagation(); toggleTodo('${subject}', ${todoIndex})">
                                    <div class="todo-checkbox ${todo.completed ? 'checked' : ''}"></div>
                                    <div class="todo-text">${todo.text}</div>
                                    <button class="todo-delete" onclick="event.stopPropagation(); deleteTodo('${subject}', ${todoIndex})">√ó</button>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    card.appendChild(todoSection);
                } else {
                    const todoSection = document.createElement('div');
                    todoSection.className = 'todo-section';
                    todoSection.innerHTML = `
                        <div style="text-align: center; padding: 10px; opacity: 0.7;">
                            <button class="add-todo-btn" onclick="event.stopPropagation(); openTodoModal('${subject}')" style="width: 100%;">
                                + Add tasks for this subject
                            </button>
                        </div>
                    `;
                    card.appendChild(todoSection);
                }
                
                card.addEventListener('click', () => selectSubject(subject));
                container.appendChild(card);
            });
            
            updateHomeStats();
        }

        function openAddSubjectModal() {
            document.getElementById('addSubjectModal').classList.add('active');
            document.getElementById('subjectNameInput').focus();
        }

        function closeAddSubjectModal() {
            document.getElementById('addSubjectModal').classList.remove('active');
            document.getElementById('subjectNameInput').value = '';
        }

        function addSubject() {
            const input = document.getElementById('subjectNameInput');
            const name = input.value.trim();
            
            if (name && !subjects.includes(name)) {
                subjects.push(name);
                saveUserData();
                renderSubjects();
                closeAddSubjectModal();
                showToast(`Subject "${name}" added`);
            } else if (subjects.includes(name)) {
                showToast('Subject already exists', 2000);
            }
        }

        function removeSubject(index) {
            if (confirm('Are you sure you want to remove this subject and all its todos?')) {
                const subject = subjects[index];
                if (selectedSubject === subject) {
                    if (homeTimerRunning) {
                        stopHomeTimer();
                    }
                    selectedSubject = null;
                    updateTimerButtons();
                    updateHomeTimerButton();
                }
                delete todos[subject];
                subjects.splice(index, 1);
                saveUserData();
                renderSubjects();
                showToast('Subject removed');
            }
        }

        function selectSubject(subject) {
            selectedSubject = subject;
            renderSubjects();
            updateTimerButtons();
            updateHomeTimerButton();
            document.getElementById('currentSubject').textContent = `üìö Selected: ${subject}`;
            document.getElementById('homeCurrentSubject').textContent = `üìö ${subject}`;
        }

        // Timer Functions
        function updateTimerButtons() {
            const startBtn = document.getElementById('startBtn');
            const stopBtn = document.getElementById('stopBtn');
            
            startBtn.disabled = !selectedSubject || isRunning;
            stopBtn.disabled = !isRunning;
        }

        function startTimer() {
            if (!selectedSubject) return;
            
            isRunning = true;
            updateTimerButtons();
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                
                if (timeRemaining <= 0) {
                    stopTimer();
                    completePomodoro();
                    showToast('üéâ Pomodoro completed! Take a 5-minute break.', 5000);
                    resetTimer();
                }
            }, 1000);
        }

        function stopTimer() {
            isRunning = false;
            clearInterval(timerInterval);
            
            const studiedMinutes = Math.floor((25 * 60 - timeRemaining) / 60);
            if (studiedMinutes > 0) {
                saveStudyTime(selectedSubject, studiedMinutes);
            }
            
            updateTimerButtons();
        }

        function resetTimer() {
            stopTimer();
            timeRemaining = 25 * 60;
            updateTimerDisplay();
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timerDisplay').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // Home Timer Functions
        function updateHomeTimerButton() {
            const btn = document.getElementById('homeStartStopBtn');
            btn.disabled = !selectedSubject;
            if (!selectedSubject) {
                document.getElementById('homeCurrentSubject').textContent = 'Select a subject to start';
            }
        }

        function toggleHomeTimer() {
            if (!selectedSubject) {
                showToast('Please select a subject first', 2000);
                return;
            }
            
            if (homeTimerRunning) {
                stopHomeTimer();
            } else {
                startHomeTimer();
            }
        }

        function startHomeTimer() {
            homeTimerRunning = true;
            const btn = document.getElementById('homeStartStopBtn');
            btn.textContent = '‚èπÔ∏è STOP';
            btn.classList.add('stop');
            
            homeTimerInterval = setInterval(() => {
                homeTimeElapsed++;
                updateHomeTimerDisplay();
                
                if (homeTimeElapsed % (25 * 60) === 0) {
                    completePomodoro();
                    showToast('üéâ 25-minute Pomodoro completed!', 3000);
                }
            }, 1000);
        }

        function stopHomeTimer() {
            homeTimerRunning = false;
            clearInterval(homeTimerInterval);
            
            const btn = document.getElementById('homeStartStopBtn');
            btn.textContent = '‚ñ∂Ô∏è START';
            btn.classList.remove('stop');
            
            const minutesStudied = Math.floor(homeTimeElapsed / 60);
            if (minutesStudied > 0 && selectedSubject) {
                saveStudyTime(selectedSubject, minutesStudied);
            }
            
            homeTimeElapsed = 0;
            updateHomeTimerDisplay();
        }

        function updateHomeTimerDisplay() {
            const minutes = Math.floor(homeTimeElapsed / 60);
            const seconds = homeTimeElapsed % 60;
            document.getElementById('homeTimerDisplay').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // Data Management
        function saveStudyTime(subject, minutes) {
            const today = getTodayDate();
            
            if (!studyData[today]) {
                studyData[today] = {};
            }
            
            if (!studyData[today][subject]) {
                studyData[today][subject] = 0;
            }
            
            studyData[today][subject] += minutes;
            saveUserData();
            updateCharts();
            renderSubjects();
            updateHomeStats();
        }

        // Charts
        let pieChart, barChart;

        function initCharts() {
            const pieCtx = document.getElementById('pieChart').getContext('2d');
            pieChart = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: [],
                    datasets: [{
                        data: [],
                        backgroundColor: [
                            '#3d4e8a',
                            '#8a4a7a',
                            '#2a5a7a',
                            '#2a6e4a',
                            '#8a3a4a',
                            '#1a5a5a',
                            '#4a2c61',
                            '#7a2e3e',
                            '#1a6a7a'
                        ],
                        borderColor: '#000000',
                        borderWidth: 3,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            labels: { 
                                color: '#e0e0e0',
                                padding: 15,
                                font: {
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(10, 10, 20, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#e0e0e0',
                            borderColor: '#3d4e8a',
                            borderWidth: 2,
                            padding: 12,
                            cornerRadius: 8
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true,
                        duration: 1500,
                        easing: 'easeInOutQuart'
                    }
                }
            });

            const barCtx = document.getElementById('barChart').getContext('2d');
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Minutes Studied',
                        data: [],
                        backgroundColor: '#3d4e8a',
                        borderColor: '#4a2c61',
                        borderWidth: 2,
                        borderRadius: 8,
                        hoverBackgroundColor: '#4a5a9a'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { 
                                color: '#e0e0e0',
                                font: {
                                    size: 12
                                }
                            },
                            grid: { 
                                color: 'rgba(255, 255, 255, 0.1)',
                                lineWidth: 1
                            }
                        },
                        x: {
                            ticks: { 
                                color: '#e0e0e0',
                                font: {
                                    size: 12
                                }
                            },
                            grid: { 
                                color: 'rgba(255, 255, 255, 0.05)',
                                lineWidth: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: { 
                                color: '#e0e0e0',
                                font: {
                                    size: 14
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(10, 10, 20, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#e0e0e0',
                            borderColor: '#3d4e8a',
                            borderWidth: 2,
                            padding: 12,
                            cornerRadius: 8
                        }
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        function updateCharts() {
            updatePieChart();
            updateBarChart();
        }

        function updatePieChart() {
            const labels = [];
            const data = [];
            
            subjects.forEach(subject => {
                const time = getTotalTimeForSubject(subject, currentGraphFilter);
                if (time > 0) {
                    labels.push(subject);
                    data.push(time);
                }
            });
            
            pieChart.data.labels = labels;
            pieChart.data.datasets[0].data = data;
            pieChart.update();
            updateStudySummary(labels, data);
        }

        function updateStudySummary(labels, data) {
            const summaryDiv = document.getElementById('studySummary');
            
            if (labels.length === 0) {
                summaryDiv.innerHTML = '<p style="text-align: center; opacity: 0.7;">üìö No study time recorded yet. Start studying to see your progress!</p>';
                return;
            }
            
            let periodText = '';
            switch(currentGraphFilter) {
                case 'today':
                    periodText = 'today';
                    break;
                case 'week':
                    periodText = 'this week';
                    break;
                case 'month':
                    periodText = 'this month';
                    break;
            }
            
            let summaryHTML = '<div style="text-align: center;">';
            summaryHTML += '<h3 style="margin-bottom: 15px; color: #43e97b;">üìñ Your Study Summary</h3>';
            
            labels.forEach((subject, index) => {
                const minutes = data[index];
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                
                let timeText = '';
                if (hours > 0 && mins > 0) {
                    timeText = `${hours}h ${mins}min`;
                } else if (hours > 0) {
                    timeText = `${hours}h`;
                } else {
                    timeText = `${mins}min`;
                }
                
                summaryHTML += `<p style="margin: 10px 0; font-size: 16px; line-height: 1.6;">üìö You studied <strong style="color: #43e97b;">${subject}</strong> for <strong style="color: #8a4a7a;">${timeText}</strong> ${periodText}</p>`;
            });
            
            const totalMinutes = data.reduce((sum, val) => sum + val, 0);
            const totalHours = Math.floor(totalMinutes / 60);
            const totalMins = totalMinutes % 60;
            
            let totalTimeText = '';
            if (totalHours > 0 && totalMins > 0) {
                totalTimeText = `${totalHours}h ${totalMins}min`;
            } else if (totalHours > 0) {
                totalTimeText = `${totalHours}h`;
            } else {
                totalTimeText = `${totalMins}min`;
            }
            
            summaryHTML += `<p style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(61, 78, 138, 0.4); font-size: 18px; font-weight: bold;">‚è±Ô∏è Total study time: <span style="color: #3d4e8a;">${totalTimeText}</span></p>`;
            summaryHTML += '</div>';
            
            summaryDiv.innerHTML = summaryHTML;
        }

        function updateBarChart() {
            const labels = [];
            const data = [];
            
            subjects.forEach(subject => {
                const time = getTotalTimeForSubject(subject, currentStreakFilter);
                labels.push(subject);
                data.push(time);
            });
            
            barChart.data.labels = labels;
            barChart.data.datasets[0].data = data;
            barChart.update();
        }

        function getTotalTimeForSubject(subject, period) {
            let total = 0;
            const now = new Date();
            
            Object.keys(studyData).forEach(date => {
                const dataDate = new Date(date);
                const daysDiff = Math.floor((now - dataDate) / (1000 * 60 * 60 * 24));
                
                let include = false;
                if (period === 'today' && daysDiff === 0) include = true;
                if (period === 'week' && daysDiff < 7) include = true;
                if (period === 'month' && daysDiff < 30) include = true;
                if (period === 'all') include = true;
                
                if (include && studyData[date][subject]) {
                    total += studyData[date][subject];
                }
            });
            
            return total;
        }

        function updateGraphFilter(filter) {
            currentGraphFilter = filter;
            document.querySelectorAll('#graphs .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            updatePieChart();
        }

        function updateStreakFilter(filter) {
            currentStreakFilter = filter;
            document.querySelectorAll('#streaks .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            updateBarChart();
        }

        // Rankings Functions
        function updateRankingFilter(filter) {
            currentRankingFilter = filter;
            document.querySelectorAll('#rankings .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            updateRankingsDisplay();
        }

        function calculateUserTotalTime(username, period) {
            const userData = allUsers[username].studyData;
            let total = 0;
            const now = new Date();
            
            Object.keys(userData).forEach(date => {
                const dataDate = new Date(date);
                const daysDiff = Math.floor((now - dataDate) / (1000 * 60 * 60 * 24));
                
                let include = false;
                if (period === 'today' && daysDiff === 0) include = true;
                if (period === 'week' && daysDiff < 7) include = true;
                if (period === 'month' && daysDiff < 30) include = true;
                if (period === 'alltime') include = true;
                
                if (include && userData[date]) {
                    Object.values(userData[date]).forEach(minutes => {
                        total += minutes;
                    });
                }
            });
            
            return total;
        }

        function updateRankingsDisplay() {
            const container = document.getElementById('rankingsTable');
            const rankings = [];
            
            Object.keys(allUsers).forEach(username => {
                const totalMinutes = calculateUserTotalTime(username, currentRankingFilter);
                if (totalMinutes > 0) {
                    rankings.push({
                        username: username,
                        totalMinutes: totalMinutes,
                        pomodoroSessions: allUsers[username].pomodoroSessions || 0,
                        streak: allUsers[username].streak || 0
                    });
                }
            });
            
            rankings.sort((a, b) => b.totalMinutes - a.totalMinutes);
            
            let html = '<div class="rankings-table">';
            html += '<div class="rankings-row header">';
            html += '<div class="rank-position">Rank</div>';
            html += '<div class="rank-username">User</div>';
            html += '<div class="rank-time">Study Time</div>';
            html += '</div>';
            
            if (rankings.length === 0) {
                html += '<div class="rankings-row"><div style="flex: 1; text-align: center; opacity: 0.7; padding: 40px;">No data available for this period üìö</div></div>';
            } else {
                rankings.forEach((rank, index) => {
                    const hours = Math.floor(rank.totalMinutes / 60);
                    const minutes = rank.totalMinutes % 60;
                    const timeText = hours > 0 ? `${hours}h ${minutes}m` : `${minutes}m`;
                    
                    const position = index + 1;
                    let positionClass = '';
                    let medal = '';
                    if (position === 1) { positionClass = 'top1'; medal = 'ü•á '; }
                    else if (position === 2) { positionClass = 'top2'; medal = 'ü•à '; }
                    else if (position === 3) { positionClass = 'top3'; medal = 'ü•â '; }
                    
                    const isCurrentUser = rank.username === currentUser;
                    
                    html += `<div class="rankings-row ${isCurrentUser ? 'current-user' : ''}">`;
                    html += `<div class="rank-position ${positionClass}">${medal}#${position}</div>`;
                    html += `<div class="rank-username">${rank.username}${isCurrentUser ? ' (You)' : ''}<br><small style="opacity:0.7;font-size:12px;">üî• ${rank.streak}d | üçÖ ${rank.pomodoroSessions}</small></div>`;
                    html += `<div class="rank-time">${timeText}</div>`;
                    html += '</div>';
                });
            }
            
            html += '</div>';
            container.innerHTML = html;
        }

        // Admin Functions
        function updateAdminPanel() {
            const totalUsers = Object.keys(allUsers).length;
            const activeToday = Object.keys(allUsers).filter(username => {
                const userData = allUsers[username].studyData;
                const today = getTodayDate();
                return userData[today] && Object.keys(userData[today]).length > 0;
            }).length;
            
            let totalStudyTime = 0;
            let totalPomodoros = 0;
            Object.keys(allUsers).forEach(username => {
                totalStudyTime += calculateUserTotalTime(username, 'alltime');
                totalPomodoros += allUsers[username].pomodoroSessions || 0;
            });
            
            const totalHours = Math.floor(totalStudyTime / 60);
            
            document.getElementById('adminStats').innerHTML = `
                <p>üë• Total Users: <strong style="color: #43e97b;">${totalUsers}</strong></p>
                <p>üî• Active Today: <strong style="color: #43e97b;">${activeToday}</strong></p>
                <p>‚è±Ô∏è Total Study Time: <strong style="color: #43e97b;">${totalHours}h ${totalStudyTime % 60}m</strong></p>
                <p>üçÖ Total Pomodoros: <strong style="color: #43e97b;">${totalPomodoros}</strong></p>
            `;
            
            const container = document.getElementById('adminUsersTable');
            let html = '<div class="admin-table">';
            html += '<div class="admin-row header">';
            html += '<div>#</div>';
            html += '<div>Username</div>';
            html += '<div>Joined Date</div>';
            html += '<div>Total Time</div>';
            html += '</div>';
            
            const usersArray = Object.keys(allUsers).map((username, index) => ({
                username: username,
                joinedDate: allUsers[username].joinedDate,
                totalTime: calculateUserTotalTime(username, 'alltime'),
                pomodoros: allUsers[username].pomodoroSessions || 0,
                streak: allUsers[username].streak || 0,
                index: index + 1
            }));
            
            usersArray.forEach(user => {
                const joinDate = new Date(user.joinedDate).toLocaleDateString();
                const hours = Math.floor(user.totalTime / 60);
                const minutes = user.totalTime % 60;
                const timeText = `${hours}h ${minutes}m`;
                
                html += '<div class="admin-row">';
                html += `<div>${user.index}</div>`;
                html += `<div>${user.username}${allUsers[user.username].isAdmin ? ' ‚öôÔ∏è' : ''}<br><small style="opacity:0.7;">üçÖ${user.pomodoros} üî•${user.streak}d</small></div>`;
                html += `<div>${joinDate}</div>`;
                html += `<div>${timeText}</div>`;
                html += '</div>';
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // Event Listeners
        document.getElementById('subjectNameInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addSubject();
            }
        });

        document.getElementById('todoInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTodo();
            }
        });

        document.getElementById('loginPassword').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleLogin();
            }
        });

        document.getElementById('signupPasswordConfirm').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                handleSignup();
            }
        });

        // Handle window resize
        window.addEventListener('resize', () => {
            if (window.innerWidth <= 767 && currentUser && !document.getElementById('fabOptions').hasChildNodes()) {
                createFabMenu();
            }
        });

        // Magical Cursor Trail Effect
        const emojiArray = ['‚è≤Ô∏è','‚åö','‚è∞','‚è±Ô∏è','üï∞Ô∏è','‚åõ','üìê','üìä','üìã','‚ù§Ô∏è','üìç','ü§©','üê§','üëÄ','üí™','‚úçÔ∏è','üéÜ','‚ú®','üéâ','üéà','üéä','üéñÔ∏è','ü•á','ü•à','ü•â','üèÜ','üìÖ','üóìÔ∏è','‚úèÔ∏è','üñãÔ∏è','‚úíÔ∏è','ü§ç','üíñ','üí´'];
        let lastEmoji = 0;
        let mouseX = 0;
        let mouseY = 0;
        let trailTimer = null;

        function createEmojiTrail(x, y) {
            const emoji = document.createElement('div');
            emoji.className = 'emoji-trail';
            emoji.textContent = emojiArray[lastEmoji];
            emoji.style.left = x + 'px';
            emoji.style.top = y + 'px';
            
            document.body.appendChild(emoji);
            
            lastEmoji = (lastEmoji + 1) % emojiArray.length;
            
            setTimeout(() => {
                emoji.remove();
            }, 2000);
        }

        document.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;

            const loginScreen = document.getElementById('loginScreen');
            const aboutPanel = document.getElementById('about');
            const isLoginVisible = loginScreen && loginScreen.style.display !== 'none';
            const isAboutVisible = aboutPanel && aboutPanel.classList.contains('active');

            if (isLoginVisible || isAboutVisible) {
                if (isLoginVisible) {
                    const loginContainer = document.querySelector('.login-container');
                    if (loginContainer) {
                        const rect = loginContainer.getBoundingClientRect();
                        if (mouseX >= rect.left && mouseX <= rect.right && 
                            mouseY >= rect.top && mouseY <= rect.bottom) {
                            return;
                        }
                    }
                }

                if (!trailTimer) {
                    createEmojiTrail(mouseX, mouseY);
                    trailTimer = setTimeout(() => {
                        trailTimer = null;
                    }, 50);
                }
            }
        });

        // Touch device optimizations
        let touchStartX = 0;
        let touchStartY = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        }, { passive: true });

        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                const panels = ['home', 'pomodoro', 'graphs', 'streaks', 'rankings', 'about', 'admin'];
                const currentPanel = document.querySelector('.panel.active').id;
                const currentIndex = panels.indexOf(currentPanel);
                
                if (diffX > 0 && currentIndex < panels.length - 1) {
                    document.querySelector(`[data-panel="${panels[currentIndex + 1]}"]`)?.click();
                } else if (diffX < 0 && currentIndex > 0) {
                    document.querySelector(`[data-panel="${panels[currentIndex - 1]}"]`)?.click();
                }
            }
        }, { passive: true });

        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });

        // Initialize touch-friendly buttons
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('touchstart', () => {
                button.style.transform = 'scale(0.95)';
            }, { passive: true });
            
            button.addEventListener('touchend', () => {
                button.style.transform = '';
            }, { passive: true });
        });
    </script>
</body>
</html>
